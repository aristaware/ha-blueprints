blueprint:
  name: eWeLink Zigbee Wireless Button (Zigbee2MQTT)
  description: >
    Configure actions for the eWeLink Zigbee wireless button using Zigbee2MQTT.
    Supports single, double, and long press events.
  domain: automation

  input:
    button_device:
      name: Zigbee Button
      description: Select the Zigbee2MQTT button device.
      selector:
        device:
          manufacturer: eWeLink
          multiple: false

    press_action:
      name: Single Press Action
      default: []
      selector:
        action: {}

    double_press_action:
      name: Double Press Action
      default: []
      selector:
        action: {}

    long_press_action:
      name: Long Press Action
      default: []
      selector:
        action: {}

variables:
  button_device: !input button_device
  ieee: "{{ device_attr(button_device, 'identifiers') | list | first | replace('zigbee2mqtt_', '') }}"

trigger:
  - platform: mqtt
    topic: "zigbee2mqtt/{{ ieee }}/action"

action:
  - choose:
      - conditions:
          - condition: template
            value_template: "{{ trigger.payload == 'single' }}"
        sequence: !input press_action

      - conditions:
          - condition: template
            value_template: "{{ trigger.payload == 'double' }}"
        sequence: !input double_press_action

      - conditions:
          - condition: template
            value_template: "{{ trigger.payload == 'long' }}"
        sequence: !input long_press_action
